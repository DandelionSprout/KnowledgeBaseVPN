<!doctype html>
<html lang="ru" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.4">
<title data-react-helmet="true">DNS filtering rules syntax | AdGuard VPN Knowledge Base</title><meta data-react-helmet="true" property="og:url" content="https://adguardteam.github.io//KnowledgeBaseVPN/ru/general/dns-filtering-syntax"><meta data-react-helmet="true" name="docusaurus_locale" content="ru"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="DNS filtering rules syntax | AdGuard VPN Knowledge Base"><meta data-react-helmet="true" name="description" content="Introduction"><meta data-react-helmet="true" property="og:description" content="Introduction"><link data-react-helmet="true" rel="shortcut icon" href="/KnowledgeBaseVPN/ru/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://adguardteam.github.io//KnowledgeBaseVPN/ru/general/dns-filtering-syntax"><link data-react-helmet="true" rel="alternate" href="https://adguardteam.github.io//KnowledgeBaseVPN/general/dns-filtering-syntax" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://adguardteam.github.io//KnowledgeBaseVPN/ru/general/dns-filtering-syntax" hreflang="ru"><link data-react-helmet="true" rel="alternate" href="https://adguardteam.github.io//KnowledgeBaseVPN/general/dns-filtering-syntax" hreflang="x-default"><link rel="stylesheet" href="/KnowledgeBaseVPN/ru/assets/css/styles.cc52ce65.css">
<link rel="preload" href="/KnowledgeBaseVPN/ru/assets/js/runtime~main.a635b8b4.js" as="script">
<link rel="preload" href="/KnowledgeBaseVPN/ru/assets/js/main.0779a69d.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">–ü–µ—Ä–µ–π—Ç–∏ –∫ –æ—Å–Ω–æ–≤–Ω–æ–º—É —Å–æ–¥–µ—Ä–∂–∏–º–æ–º—É</a></div><nav class="navbar navbar--fixed-top navbarHideable_2qcr"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/KnowledgeBaseVPN/ru/"><img src="/KnowledgeBaseVPN/ru/img/logo.svg" alt="AdGuard DNS" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/KnowledgeBaseVPN/ru/img/logo_dark.svg" alt="AdGuard DNS" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><b class="navbar__title"></b></a><a class="navbar__item navbar__link navbar__link--active" href="/KnowledgeBaseVPN/ru/">docs</a><a href="https://adguard.com/blog/tag/adguard-dns.html" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">blog</a><a href="https://adguard-dns.io" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">official_website</a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" class="navbar__item navbar__link"><span><svg viewBox="0 0 20 20" width="20" height="20" aria-hidden="true" style="vertical-align:text-bottom;margin-right:5px"><path fill="currentColor" d="M19.753 10.909c-.624-1.707-2.366-2.726-4.661-2.726-.09 0-.176.002-.262.006l-.016-2.063 3.525-.607c.115-.019.133-.119.109-.231-.023-.111-.167-.883-.188-.976-.027-.131-.102-.127-.207-.109-.104.018-3.25.461-3.25.461l-.013-2.078c-.001-.125-.069-.158-.194-.156l-1.025.016c-.105.002-.164.049-.162.148l.033 2.307s-3.061.527-3.144.543c-.084.014-.17.053-.151.143.019.09.19 1.094.208 1.172.018.08.072.129.188.107l2.924-.504.035 2.018c-1.077.281-1.801.824-2.256 1.303-.768.807-1.207 1.887-1.207 2.963 0 1.586.971 2.529 2.328 2.695 3.162.387 5.119-3.06 5.769-4.715 1.097 1.506.256 4.354-2.094 5.98-.043.029-.098.129-.033.207l.619.756c.08.096.206.059.256.023 2.51-1.73 3.661-4.515 2.869-6.683zm-7.386 3.188c-.966-.121-.944-.914-.944-1.453 0-.773.327-1.58.876-2.156a3.21 3.21 0 011.229-.799l.082 4.277a2.773 2.773 0 01-1.243.131zm2.427-.553l.046-4.109c.084-.004.166-.01.252-.01.773 0 1.494.145 1.885.361.391.217-1.023 2.713-2.183 3.758zm-8.95-7.668a.196.196 0 00-.196-.145h-1.95a.194.194 0 00-.194.144L.008 16.916c-.017.051-.011.076.062.076h1.733c.075 0 .099-.023.114-.072l1.008-3.318h3.496l1.008 3.318c.016.049.039.072.113.072h1.734c.072 0 .078-.025.062-.076-.014-.05-3.083-9.741-3.494-11.04zm-2.618 6.318l1.447-5.25 1.447 5.25H3.226z"></path></svg><span>—Ä—É—Å—Å–∫–∏–π</span></span></a><ul class="dropdown__menu"><li><a href="/KnowledgeBaseVPN/general/dns-filtering-syntax" target="_self" rel="noopener noreferrer" class="dropdown__link" style="text-transform:capitalize">English</a></li><li><a href="/KnowledgeBaseVPN/ru/general/dns-filtering-syntax" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" style="text-transform:capitalize">—Ä—É—Å—Å–∫–∏–π</a></li></ul></div><a href="https://github.com/AdguardTeam/KnowledgeBaseVPN" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>github<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="react-toggle toggle_3Zt9 react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_71bT">üåú</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">üåû</span></div><div class="react-toggle-thumb"></div></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper doc-page"><div class="docPage_31aa"><button class="clean-btn backToTopButton_35hR" type="button" title="Scroll to top"><svg viewBox="0 0 24 24" width="28"><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z" fill="currentColor"></path></svg></button><aside class="docSidebarContainer_3Kbt"><div class="sidebar_15mo sidebarWithHideableNavbar_267A"><a tabindex="-1" class="sidebarLogo_3h0W" href="/KnowledgeBaseVPN/ru/"><img src="/KnowledgeBaseVPN/ru/img/logo.svg" alt="AdGuard DNS" class="themedImage_1VuW themedImage--light_3UqQ"><img src="/KnowledgeBaseVPN/ru/img/logo_dark.svg" alt="AdGuard DNS" class="themedImage_1VuW themedImage--dark_hz6m"><b></b></a><nav class="menu thin-scrollbar menu_Bmed menuWithAnnouncementBar_2WvA"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/KnowledgeBaseVPN/ru/">Overview</a></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">General</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/KnowledgeBaseVPN/ru/general/dns-filtering">DNS filtering</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/KnowledgeBaseVPN/ru/general/dns-filtering-syntax">DNS filtering rules syntax</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/KnowledgeBaseVPN/ru/general/dns-providers">Known DNS Providers</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Public DNS</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Private DNS</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Miscellaneous</a></li></ul></nav><button type="button" title="–°–≤–µ—Ä–Ω—É—Ç—å —Å–∞–π–¥–±–∞—Ä" aria-label="–°–≤–µ—Ä–Ω—É—Ç—å —Å–∞–π–¥–±–∞—Ä" class="button button--secondary button--outline collapseSidebarButton_1CGd"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_3E-R"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></aside><main class="docMainContainer_3ufF"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><div class="tocCollapsible_1PrD tocMobile_3Hoh"><button type="button" class="clean-btn tocCollapsibleButton_2O1e">–°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ —ç—Ç–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã</button></div><div class="markdown"><header><h1 class="h1Heading_27L5">DNS filtering rules syntax</h1></header><h2><a aria-hidden="true" tabindex="-1" class="anchor" id="introduction"></a>Introduction<a class="hash-link" href="#introduction" title="–ü—Ä—è–º–∞—è —Å—Å—ã–ª–∫–∞ –Ω–∞ —ç—Ç–æ—Ç –∑–∞–≥–æ–ª–æ–≤–æ–∫">#</a></h2><p>You can use AdGuard DNS filtering rules syntax to make the rules more flexible, so they can block content according to your preferences.
AdGuard DNS filtering rules syntax can be used in different AdGuard products such as AdGuard Home, AdGuard DNS, AdGuard for Windows/Mac/Android.</p><p>There are three different approaches to writing hosts blocklists:</p><ul><li><p><a href="#adblock-style-syntax">Adblock-style syntax</a>: the modern approach to writing
filtering rules based on using a subset of the Adblock-style rule syntax.
This way blocklists are compatible with browser ad blockers.</p></li><li><p><a href="#etc-hosts-syntax"><code>/etc/hosts</code> syntax</a>: the old, tried-and-true approach that
uses the same syntax that operating systems do for their hosts files.</p></li><li><p><a href="#domains-only-syntax">Domains-only syntax</a>: a simple list of domain names.</p></li></ul><p>If you are creating a blocklist for AdGuard Home, we recommend using the
<a href="#adblock-style-syntax">Adblock-style syntax</a>. It has a couple of important advantages
over the old-style syntax:</p><ul><li><p><strong>Blocklists size.</strong>  Using pattern matching allows you to have a single
rule instead of hundreds of <code>/etc/hosts</code> entries.</p></li><li><p><strong>Compatibility.</strong>  Your blocklist will be compatible with browser ad
blockers, and it will be easier to share rules with a browser filter list.</p></li><li><p><strong>Extensibility.</strong>  For the last decade the Adblock-style syntax has greatly
evolved, and we don&#x27;t see why we can&#x27;t extend it even more and provide
additional features for network-wide blockers.</p></li></ul><p>If you&#x27;re maintaining an <code>/etc/hosts</code>-style blocklist or if you maintain
multiple filter lists regardless of their type, we provide a tool that can be
used to compile blocklists for AdGuard Home.  We called it <a href="https://github.com/AdguardTeam/HostlistCompiler" target="_blank" rel="noopener noreferrer">Hostlist
compiler</a> and we use it ourselves to create <a href="https://github.com/AdguardTeam/AdGuardSDNSFilter" target="_blank" rel="noopener noreferrer">AdGuard DNS filter</a>.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor" id="basic-examples"></a>Basic Examples<a class="hash-link" href="#basic-examples" title="–ü—Ä—è–º–∞—è —Å—Å—ã–ª–∫–∞ –Ω–∞ —ç—Ç–æ—Ç –∑–∞–≥–æ–ª–æ–≤–æ–∫">#</a></h2><ul><li><p><code>||example.org^</code>: block access to the <code>example.org</code> domain and all its
subdomains, like <code>www.example.org</code>.</p></li><li><p><code>@@||example.org^</code>: unblock access to the <code>example.org</code> domain and all its
subdomains.</p></li><li><p><code>1.2.3.4 example.org</code>: (attention, old <code>/etc/hosts</code>-style syntax) respond
with <code>1.2.3.4</code> to queries for the <code>example.org</code> domain but <strong>not</strong> its
subdomains.  <code>www.example.org</code> remains allowed.</p><p>Using the unspecified IP address (<code>0.0.0.0</code>) or a local address (<code>127.0.0.1</code>
and alike) for a host is basically the same as blocking that host.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly none"><pre tabindex="0" class="prism-code language-none codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain"># Returns the IP address 1.2.3.4 for example.org.</span></span><span class="token-line" style="color:#393A34"><span class="token plain">1.2.3.4 example.org</span></span><span class="token-line" style="color:#393A34"><span class="token plain"># Blocks example.com by responding with 0.0.0.0.</span></span><span class="token-line" style="color:#393A34"><span class="token plain">0.0.0.0 example.com</span></span></code></pre><button type="button" aria-label="–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞" class="copyButton_Ue-o clean-btn">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å</button></div></div></li><li><p><code>example.org</code>: a simple domain rule.  Blocks <code>example.org</code> domain but
<strong>not</strong> its subdomains.  <code>www.example.org</code> remains allowed.</p></li><li><p><code>! Here goes a comment</code> and <code># Also a comment</code>: comments.</p></li><li><p><code>/REGEX/</code>: block access to the domains matching the specified regular
expression</p></li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor" id="adblock-style-syntax"></a>Adblock-Style Syntax<a class="hash-link" href="#adblock-style-syntax" title="–ü—Ä—è–º–∞—è —Å—Å—ã–ª–∫–∞ –Ω–∞ —ç—Ç–æ—Ç –∑–∞–≥–æ–ª–æ–≤–æ–∫">#</a></h2><p>This is a subset of the <a href="https://kb.adguard.com/en/general/how-to-create-your-own-ad-filters" target="_blank" rel="noopener noreferrer">traditional Adblock-style</a> syntax which is used by
browser ad blockers.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly none"><pre tabindex="0" class="prism-code language-none codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">     rule = [&quot;@@&quot;] pattern [ &quot;$&quot; modifiers ]</span></span><span class="token-line" style="color:#393A34"><span class="token plain">modifiers = [modifier0, modifier1[, ...[, modifierN]]]</span></span></code></pre><button type="button" aria-label="–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞" class="copyButton_Ue-o clean-btn">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å</button></div></div><ul><li><p><code>pattern</code>: the hostname mask.  Every hostname is matched against this mask.
The pattern can also contain special characters, which are described below.</p></li><li><p><code>@@</code>: the marker that is used in the exception rules.  Start your rule with
this marker if you want to turn off filtering for the matching hostnames.</p></li><li><p><code>modifiers</code>: parameters that clarify the rule.  They may limit the scope of
the rule or even completely change the way it works.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor" id="special-characters"></a>Special Characters<a class="hash-link" href="#special-characters" title="–ü—Ä—è–º–∞—è —Å—Å—ã–ª–∫–∞ –Ω–∞ —ç—Ç–æ—Ç –∑–∞–≥–æ–ª–æ–≤–æ–∫">#</a></h3></li><li><p><code>*</code>: the wildcard character.  It is used to represent any set of characters.
This can also be an empty string or a string of any length.</p></li><li><p><code>||</code>: matches the beginning of a hostname, including any subdomain.  For
instance, <code>||example.org</code> matches <code>example.org</code> and <code>test.example.org</code> but
not <code>testexample.org</code>.</p></li><li><p><code>^</code>: the separator character.  Unlike browser ad blocking, there&#x27;s nothing
to separate in a hostname, so the only purpose of this character is to mark
the end of the hostname.</p></li><li><p><code>|</code>: a pointer to the beginning or the end of the hostname.  The value
depends on the character placement in the mask.  For example, the rule
<code>ample.org|</code> corresponds to <code>example.org</code> but not to <code>example.org.com</code>.
<code>|example</code> corresponds to <code>example.org</code> but not to <code>test.example</code>.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor" id="regular-expressions"></a>Regular Expressions<a class="hash-link" href="#regular-expressions" title="–ü—Ä—è–º–∞—è —Å—Å—ã–ª–∫–∞ –Ω–∞ —ç—Ç–æ—Ç –∑–∞–≥–æ–ª–æ–≤–æ–∫">#</a></h3></li></ul><p>If you want even more flexibility in making rules, you can use <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Regular_Expressions" target="_blank" rel="noopener noreferrer">regular
expressions</a> instead of the default simplified matching syntax.  If you
want to use a regular expression, the pattern has to look like this:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly none"><pre tabindex="0" class="prism-code language-none codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">pattern = &quot;/&quot; regexp &quot;/&quot;</span></span></code></pre><button type="button" aria-label="–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞" class="copyButton_Ue-o clean-btn">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å</button></div></div><p><strong>Examples:</strong></p><ul><li><p><code>/example.*/</code> will block hosts matching the <code>example.*</code> regexp.</p></li><li><p><code>@@/example.*/$important</code> will unblock hosts matching the <code>example.*</code>
regexp.  Note that this rule also implies the <code>important</code> modifier.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor" id="comments"></a>Comments<a class="hash-link" href="#comments" title="–ü—Ä—è–º–∞—è —Å—Å—ã–ª–∫–∞ –Ω–∞ —ç—Ç–æ—Ç –∑–∞–≥–æ–ª–æ–≤–æ–∫">#</a></h3></li></ul><p>Any line that starts with an exclamation mark or a hash sign is a comment and it
will be ignored by the filtering engine.  Comments are usually placed above
rules and used to describe what a rule does.</p><p><strong>Example:</strong></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly none"><pre tabindex="0" class="prism-code language-none codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">! This is a comment.</span></span><span class="token-line" style="color:#393A34"><span class="token plain"># This is also a comment.</span></span></code></pre><button type="button" aria-label="–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞" class="copyButton_Ue-o clean-btn">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor" id="rule-modifiers"></a>Rule Modifiers<a class="hash-link" href="#rule-modifiers" title="–ü—Ä—è–º–∞—è —Å—Å—ã–ª–∫–∞ –Ω–∞ —ç—Ç–æ—Ç –∑–∞–≥–æ–ª–æ–≤–æ–∫">#</a></h3><p>You can change the behavior of a rule by adding modifiers.  Modifiers must be
located at the end of the rule after the <code>$</code> character and be separated by
commas.</p><p><strong>Examples:</strong></p><ul><li><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly none"><pre tabindex="0" class="prism-code language-none codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">||example.org^$important</span></span></code></pre><button type="button" aria-label="–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞" class="copyButton_Ue-o clean-btn">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å</button></div></div><p><code>||example.org^</code> is the matching pattern.  <code>$</code> is the delimiter, which
signals that the rest of the rule are modifiers.  <code>important</code> is the
modifier.</p></li><li><p>You may want to use multiple modifiers in a rule.  Separate them by commas
in this case:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly none"><pre tabindex="0" class="prism-code language-none codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">||example.org^$client=127.0.0.1,dnstype=A</span></span></code></pre><button type="button" aria-label="–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞" class="copyButton_Ue-o clean-btn">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å</button></div></div><p><code>||example.org^</code> is the matching pattern.  <code>$</code> is the delimiter, which
signals that the rest of the rule are modifiers.  <code>client=127.0.0.1</code> is the
<a href="#client"><code>client</code></a> modifier with its value, <code>127.0.0.1</code>, is the delimiter.
And finally, <code>dnstype=A</code> is the <a href="#dnstype"><code>dnstype</code></a> modifier with its
value, <code>A</code>.</p></li></ul><p><strong>NOTE:</strong>  If a rule contains a modifier not listed in this document, the whole
rule <strong>must be ignored</strong>.  This way we avoid false-positives when people are
trying to use unmodified browser ad blockers&#x27; filter lists like EasyList or
EasyPrivacy.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor" id="client"></a><code>client</code><a class="hash-link" href="#client" title="–ü—Ä—è–º–∞—è —Å—Å—ã–ª–∫–∞ –Ω–∞ —ç—Ç–æ—Ç –∑–∞–≥–æ–ª–æ–≤–æ–∫">#</a></h4><p>The <code>client</code> modifier allows specifying clients this rule is applied to.  There
are two main ways to identify a client:</p><ul><li><p>By their IP address or CIDR prefix.  This way works for all kinds of
clients.</p></li><li><p>By their name.  This way only works for persistent clients, that is clients
which you have manually added on the ‚ÄúSettings ‚Üí Client settings‚Äù page.</p><p><strong>NOTE:</strong> ClientIDs are not currently supported, only names are.  If you
have added a client with the name ‚ÄúMy Client‚Äù and ClientID <code>my-client</code>,
spell your modifier as <code>$client=&#x27;My Client&#x27;</code> as opposed to
<code>$client=my-client</code>.</p></li></ul><p>The syntax is:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly none"><pre tabindex="0" class="prism-code language-none codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">$client=value1|value2|...</span></span></code></pre><button type="button" aria-label="–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞" class="copyButton_Ue-o clean-btn">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å</button></div></div><p>You can also exclude clients by adding a <code>~</code> character before the value.  In
this case, the rule is not be applied to this client&#x27;s DNS requests.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly none"><pre tabindex="0" class="prism-code language-none codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">$client=~value1</span></span></code></pre><button type="button" aria-label="–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞" class="copyButton_Ue-o clean-btn">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å</button></div></div><p>Client names usually contain spaces or other special characters, which is why
you should enclose the name in quotes.  Both single and double ASCII quotes are
supported.  Use the backslash (<code>\</code>) to escape quotes (<code>&quot;</code> and <code>&#x27;</code>), commas
(<code>,</code>), and pipes (<code>|</code>).</p><p><strong>NOTE:</strong> When excluding a client, you <strong>must</strong> keep <code>~</code> out of the quotes.</p><p><strong>Examples:</strong></p><ul><li><p><code>@@||*^$client=127.0.0.1</code>: unblock everything for localhost.</p></li><li><p><code>||example.org^$client=&#x27;Frank\&#x27;s laptop&#x27;</code>: block <code>example.org</code> for the
client named <code>Frank&#x27;s laptop</code> only.  Note that quote (<code>&#x27;</code>) in the name must
be escaped.</p></li><li><p><code>||example.org^$client=~&#x27;Mary\&#x27;s\, John\&#x27;s\, and Boris\&#x27;s laptops&#x27;</code>: block
<code>example.org</code> for everyone except for the client named <code>Mary&#x27;s, John&#x27;s, and
Boris&#x27;s laptops</code>.  Note that comma (<code>,</code>) must be escaped as well.</p></li><li><p><code>||example.org^$client=~Mom|~Dad|Kids</code>: block <code>example.org</code> for <code>Kids</code>, but
not for <code>Mom</code> and <code>Dad</code>.  This example demonstrates how to specify multiple
clients in one rule.</p></li><li><p><code>||example.org^$client=192.168.0.0/24</code>: block <code>example.org</code> for all clients
with IP addresses in the range from <code>192.168.0.0</code> to <code>192.168.0.255</code>.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor" id="denyallow"></a><code>denyallow</code><a class="hash-link" href="#denyallow" title="–ü—Ä—è–º–∞—è —Å—Å—ã–ª–∫–∞ –Ω–∞ —ç—Ç–æ—Ç –∑–∞–≥–æ–ª–æ–≤–æ–∫">#</a></h4></li></ul><p>Available since <strong>v0.106.0</strong>.</p><p>You can use the <code>denyallow</code> modifier to exclude domains from the blocking rule.
To add multiple domains to one rule, use the <code>|</code> character as a separator.</p><p>The syntax is:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly none"><pre tabindex="0" class="prism-code language-none codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">$denyallow=domain1|domain2|...</span></span></code></pre><button type="button" aria-label="–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞" class="copyButton_Ue-o clean-btn">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å</button></div></div><p>This modifier allows avoiding creating unnecessary exception rules when our
blocking rule covers too many domains.  You may want to block everything save
for a couple of TLD domains. You could use the standard approach, i.e. rules
like this:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly none"><pre tabindex="0" class="prism-code language-none codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">! Block everything.</span></span><span class="token-line" style="color:#393A34"><span class="token plain">/.*/</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">! Unblock a couple of TLDs.</span></span><span class="token-line" style="color:#393A34"><span class="token plain">@@||com^</span></span><span class="token-line" style="color:#393A34"><span class="token plain">@@||net^</span></span></code></pre><button type="button" aria-label="–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞" class="copyButton_Ue-o clean-btn">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å</button></div></div><p>The problem with this approach is that this way you will also unblock tracking
domains that are located on those TLDs (i.e. <code>google-analytics.com</code>).  Here&#x27;s
how to solve this with <code>denyallow</code>:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly none"><pre tabindex="0" class="prism-code language-none codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">*$denyallow=com|net</span></span></code></pre><button type="button" aria-label="–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞" class="copyButton_Ue-o clean-btn">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å</button></div></div><p><strong>Examples:</strong></p><ul><li><p><code>*$denyallow=com|net</code>: block everything save for <code>*.com</code> and <code>*.net</code>.</p></li><li><p><code>@@*$denyallow=com|net</code>: unblock everything save for <code>*.com</code> and <code>*.net</code>.</p></li><li><p><code>||example.org^$denyallow=sub.example.org</code>. block <code>example.org</code> and
<code>*.example.org</code> but don&#x27;t block <code>sub.example.org</code>.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor" id="dnstype"></a><a href="#dnstype" id="dnstype"><code>dnstype</code></a><a class="hash-link" href="#dnstype" title="–ü—Ä—è–º–∞—è —Å—Å—ã–ª–∫–∞ –Ω–∞ —ç—Ç–æ—Ç –∑–∞–≥–æ–ª–æ–≤–æ–∫">#</a></h4></li></ul><p>Available since <strong>v0.105.0</strong>.</p><p>The <code>dnstype</code> modifier allows specifying DNS request or response type on which
this rule will be triggered.</p><p>The syntax is:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly none"><pre tabindex="0" class="prism-code language-none codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">$dnstype=value1|value2|...</span></span><span class="token-line" style="color:#393A34"><span class="token plain">$dnstype=~value1|~value2|~...</span></span></code></pre><button type="button" aria-label="–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞" class="copyButton_Ue-o clean-btn">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å</button></div></div><p>The names of the types are case-insensitive, but are validated against a set of
actual DNS resource record (RR) types.</p><p>Do not combine exclusion rules with inclusion ones.  This:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly none"><pre tabindex="0" class="prism-code language-none codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">$dnstype=~value1|value2</span></span></code></pre><button type="button" aria-label="–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞" class="copyButton_Ue-o clean-btn">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å</button></div></div><p>is equivalent to this:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly none"><pre tabindex="0" class="prism-code language-none codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">$dnstype=value2</span></span></code></pre><button type="button" aria-label="–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞" class="copyButton_Ue-o clean-btn">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å</button></div></div><p><strong>Examples:</strong></p><ul><li><p><code>||example.org^$dnstype=AAAA</code>: block DNS queries for the IPv6 addresses of
<code>example.org</code>.</p></li><li><p><code>||example.org^$dnstype=~A|~CNAME</code>: only allow <code>A</code> and <code>CNAME</code> DNS queries
for <code>example.org</code>, block out the rest.</p></li></ul><p><strong>NOTE:</strong> Before version <strong>v0.108.0,</strong> AdGuard Home would use the type of the
request to filter the response records, as opposed to the type of the response
record itself.  That caused issues, since that meant that you could not write
rules that would allow certain <code>CNAME</code> records in responses in <code>A</code> and <code>AAAA</code>
requests.  In <strong>v0.108.0</strong> that behaviour was changed, so now this:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly none"><pre tabindex="0" class="prism-code language-none codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">||canon.example.com^$dnstype=~CNAME</span></span></code></pre><button type="button" aria-label="–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞" class="copyButton_Ue-o clean-btn">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å</button></div></div><p>allows you to avoid filtering of the following response:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly none"><pre tabindex="0" class="prism-code language-none codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">ANSWERS:</span></span><span class="token-line" style="color:#393A34"><span class="token plain">-&gt;  example.com</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    canonical name = canon.example.com.</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    ttl = 60</span></span><span class="token-line" style="color:#393A34"><span class="token plain">-&gt;  canon.example.com</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    internet address = 1.2.3.4</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    ttl = 60</span></span></code></pre><button type="button" aria-label="–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞" class="copyButton_Ue-o clean-btn">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor" id="dnsrewrite"></a><code>dnsrewrite</code><a class="hash-link" href="#dnsrewrite" title="–ü—Ä—è–º–∞—è —Å—Å—ã–ª–∫–∞ –Ω–∞ —ç—Ç–æ—Ç –∑–∞–≥–æ–ª–æ–≤–æ–∫">#</a></h4><p>Available since <strong>v0.105.0</strong>.</p><p>The <code>dnsrewrite</code> response modifier allows replacing the content of the response
to the DNS request for the matching hosts.  Rules with the <code>dnsrewrite</code>
response modifier have higher priority than other rules in AdGuard Home.</p><p>The shorthand syntax is:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly none"><pre tabindex="0" class="prism-code language-none codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">$dnsrewrite=1.2.3.4</span></span><span class="token-line" style="color:#393A34"><span class="token plain">$dnsrewrite=abcd::1234</span></span><span class="token-line" style="color:#393A34"><span class="token plain">$dnsrewrite=example.net</span></span><span class="token-line" style="color:#393A34"><span class="token plain">$dnsrewrite=REFUSED</span></span></code></pre><button type="button" aria-label="–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞" class="copyButton_Ue-o clean-btn">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å</button></div></div><p>The keywords MUST be in all caps (e.g. <code>NOERROR</code>).  Keyword rewrites take
precedence over the other and will result in an empty response with an
appropriate response code.</p><p>Before <strong>v0.107.3</strong> the only possible keyword is <code>REFUSED</code>.</p><p>Since <strong>v0.107.3</strong> response codes <code>NOERROR</code>, <code>NXDOMAIN</code>, and <code>SERVFAIL</code> are also
supported.</p><p>The full syntax is of the form <code>RCODE;RRTYPE;VALUE</code>:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly none"><pre tabindex="0" class="prism-code language-none codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">$dnsrewrite=NOERROR;A;1.2.3.4</span></span><span class="token-line" style="color:#393A34"><span class="token plain">$dnsrewrite=NOERROR;AAAA;abcd::1234</span></span><span class="token-line" style="color:#393A34"><span class="token plain">$dnsrewrite=NOERROR;CNAME;example.net</span></span><span class="token-line" style="color:#393A34"><span class="token plain">$dnsrewrite=REFUSED;;</span></span></code></pre><button type="button" aria-label="–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞" class="copyButton_Ue-o clean-btn">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å</button></div></div><p>Since <strong>v0.107.3</strong> a <code>$dnsrewrite</code> modifier with the <code>NOERROR</code> response code may
also has empty <code>RRTYPE</code> and <code>VALUE</code> fields.</p><p>The <code>CNAME</code> one is special because AdGuard Home will resolve the host and add
its info to the response.  That is, if <code>example.net</code> has IP <code>1.2.3.4</code>, and the
user has this in their filter rules:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly none"><pre tabindex="0" class="prism-code language-none codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">||example.com^$dnsrewrite=example.net</span></span><span class="token-line" style="color:#393A34"><span class="token plain">! Or:</span></span><span class="token-line" style="color:#393A34"><span class="token plain">||example.com^$dnsrewrite=NOERROR;CNAME;example.net</span></span></code></pre><button type="button" aria-label="–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞" class="copyButton_Ue-o clean-btn">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å</button></div></div><p>then the response will be something like:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly sh"><pre tabindex="0" class="prism-code language-sh codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">$ nslookup example.com my.adguard.local</span></span></code></pre><button type="button" aria-label="–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞" class="copyButton_Ue-o clean-btn">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å</button></div></div><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly none"><pre tabindex="0" class="prism-code language-none codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">Server:     my.adguard.local</span></span><span class="token-line" style="color:#393A34"><span class="token plain">Address:    127.0.0.1#53</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">Non-authoritative answer:</span></span><span class="token-line" style="color:#393A34"><span class="token plain">example.com canonical name = example.net.</span></span><span class="token-line" style="color:#393A34"><span class="token plain">Name:   example.net</span></span><span class="token-line" style="color:#393A34"><span class="token plain">Address: 1.2.3.4</span></span></code></pre><button type="button" aria-label="–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞" class="copyButton_Ue-o clean-btn">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å</button></div></div><p>Next, the <code>CNAME</code> rewrite.  After that, all other records&#x27;s values are summed as
one response, so this:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly none"><pre tabindex="0" class="prism-code language-none codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">||example.com^$dnsrewrite=NOERROR;A;1.2.3.4</span></span><span class="token-line" style="color:#393A34"><span class="token plain">||example.com^$dnsrewrite=NOERROR;A;1.2.3.5</span></span></code></pre><button type="button" aria-label="–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞" class="copyButton_Ue-o clean-btn">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å</button></div></div><p>will result in a response with two <code>A</code> records.</p><p>Currently supported RR types with examples:</p><ul><li><p><code>||4.3.2.1.in-addr.arpa^$dnsrewrite=NOERROR;PTR;example.net.</code> adds a <code>PTR</code>
record for reverse DNS.  Reverse DNS requests for <code>1.2.3.4</code> to the
AdGuard Home DNS server will result in <code>example.net</code>.</p><p><strong>NOTE:</strong> the IP MUST be in reverse order.  Before <strong>v0.106.0</strong>, the value
had to contain a final dot, but since <strong>v0.106.0</strong> both forms are accepted.
See <a href="https://tools.ietf.org/html/rfc1035#section-3.5" target="_blank" rel="noopener noreferrer">RFC 1035</a>.</p></li><li><p><code>||example.com^$dnsrewrite=NOERROR;A;1.2.3.4</code> adds an <code>A</code> record with the
value <code>1.2.3.4</code>.</p></li><li><p><code>||example.com^$dnsrewrite=NOERROR;AAAA;abcd::1234</code> adds an <code>AAAA</code> record
with the value <code>abcd::1234</code>.</p></li><li><p><code>||example.com^$dnsrewrite=NOERROR;CNAME;example.org</code> adds a <code>CNAME</code> record.
See explanation above.</p></li><li><p><code>||example.com^$dnsrewrite=NOERROR;HTTPS;32 example.com alpn=h3</code> adds an
<code>HTTPS</code> record.  Only a subset of parameter values is supported: values must
be <code>contiguous</code> and, where a <code>value-list</code> is expected`, only one value is
currently supported:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly none"><pre tabindex="0" class="prism-code language-none codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">ipv4hint=127.0.0.1             // Supported.</span></span><span class="token-line" style="color:#393A34"><span class="token plain">ipv4hint=&quot;127.0.0.1&quot;           // Unsupported.</span></span><span class="token-line" style="color:#393A34"><span class="token plain">ipv4hint=127.0.0.1,127.0.0.2   // Unsupported.</span></span><span class="token-line" style="color:#393A34"><span class="token plain">ipv4hint=&quot;127.0.0.1,127.0.0.2&quot; // Unsupported.</span></span></code></pre><button type="button" aria-label="–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞" class="copyButton_Ue-o clean-btn">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å</button></div></div><p>This will change in the future.</p></li><li><p><code>||example.com^$dnsrewrite=NOERROR;MX;32 example.mail</code> adds an <code>MX</code> record
with precedence value <code>32</code> and exchange value <code>example.mail</code>.</p></li><li><p><code>||example.com^$dnsrewrite=NOERROR;SVCB;32 example.com alpn=h3</code> adds and
<code>SVCB</code> value.  See the <code>HTTPS</code> example above.</p></li><li><p><code>||example.com^$dnsrewrite=NOERROR;TXT;hello_world</code> adds a <code>TXT</code> record with
the value <code>hello_world</code>.</p></li><li><p><code>||_svctype._tcp.example.com^$dnsrewrite=NOERROR;SRV;10 60 8080 example.com</code>
adds an <code>SRV</code> record with priority value <code>10</code>, weight value <code>60</code>, port
<code>8080</code>, and target value <code>example.com</code>.</p></li><li><p><code>||example.com^$dnsrewrite=NXDOMAIN;;</code> responds with an <code>NXDOMAIN</code> code.</p></li><li><p><code>$dnstype=AAAA,denyallow=example.org,dnsrewrite=NOERROR;;</code> responds with an
empty <code>NOERROR</code> answers for all <code>AAAA</code> requests except the ones for
<code>example.org</code>.</p><p><strong>NOTE:</strong> this is available since <strong>v0.107.3</strong>.</p></li></ul><p>Exception rules remove one or all rules:</p><ul><li><p><code>@@||example.com^$dnsrewrite</code> removes all DNS rewrite rules.</p></li><li><p><code>@@||example.com^$dnsrewrite=1.2.3.4</code> removes the DNS rewrite rule that adds
an <code>A</code> record with the value <code>1.2.3.4</code>.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor" id="important"></a><a href="#important" id="important"><code>important</code></a><a class="hash-link" href="#important" title="–ü—Ä—è–º–∞—è —Å—Å—ã–ª–∫–∞ –Ω–∞ —ç—Ç–æ—Ç –∑–∞–≥–æ–ª–æ–≤–æ–∫">#</a></h4></li></ul><p>The <code>important</code> modifier applied to a rule increases its priority over any
other rule without the modifier.  Even over basic exception rules.</p><p><strong>Examples:</strong></p><ul><li><p>In this example:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly none"><pre tabindex="0" class="prism-code language-none codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">||example.org^$important</span></span><span class="token-line" style="color:#393A34"><span class="token plain">@@||example.org^</span></span></code></pre><button type="button" aria-label="–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞" class="copyButton_Ue-o clean-btn">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å</button></div></div><p><code>||example.org^$important</code> will block all requests to <code>*.example.org</code>.
despite the exception rule.</p></li><li><p>In this example:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly none"><pre tabindex="0" class="prism-code language-none codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">||example.org^$important</span></span><span class="token-line" style="color:#393A34"><span class="token plain">@@||example.org^$important</span></span></code></pre><button type="button" aria-label="–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞" class="copyButton_Ue-o clean-btn">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å</button></div></div><p>  the exception rule also has the <code>important</code> modifier, so it will work.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor" id="badfilter"></a><code>badfilter</code><a class="hash-link" href="#badfilter" title="–ü—Ä—è–º–∞—è —Å—Å—ã–ª–∫–∞ –Ω–∞ —ç—Ç–æ—Ç –∑–∞–≥–æ–ª–æ–≤–æ–∫">#</a></h4></li></ul><p>The rules with the <code>badfilter</code> modifier disable other basic rules to which they
refer.  It means that the text of the disabled rule should match the text of the
<code>badfilter</code> rule (without the <code>badfilter</code> modifier).</p><p><strong>Examples:</strong></p><ul><li><p><code>||example.com$badfilter</code> disables <code>||example.com</code>.</p></li><li><p><code>@@||example.org^$badfilter</code> disables <code>@@||example.org^</code>.</p></li></ul><p><strong>NOTE:</strong>  The <code>badfilter</code> modifier currently doesn&#x27;t work with
<code>/etc/hosts</code>-style rules.  <code>127.0.0.1 example.org$badfilter</code> will <strong>not</strong>
disable the original <code>127.0.0.1 example.org</code> rule.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor" id="ctag"></a><code>ctag</code><a class="hash-link" href="#ctag" title="–ü—Ä—è–º–∞—è —Å—Å—ã–ª–∫–∞ –Ω–∞ —ç—Ç–æ—Ç –∑–∞–≥–æ–ª–æ–≤–æ–∫">#</a></h4><p>The <code>ctag</code> modifier allows to block domains only for specific types of DNS
client tags.  You can assign tags to clients in the AdGuard Home UI.  In the
future, we plan to assign tags automatically by analyzing the behavior of each
client.</p><p>The syntax is:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly none"><pre tabindex="0" class="prism-code language-none codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">$ctag=value1|value2|...</span></span></code></pre><button type="button" aria-label="–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞" class="copyButton_Ue-o clean-btn">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å</button></div></div><p>If one of client&#x27;s tags matches the <code>ctag</code> values, this rule applies to the
client.  The syntax for exclusion is:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly none"><pre tabindex="0" class="prism-code language-none codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">$ctag=~value1|~value2|...</span></span></code></pre><button type="button" aria-label="–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞" class="copyButton_Ue-o clean-btn">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å</button></div></div><p>If one of client&#x27;s tags matches the exclusion <code>ctag</code> values, this rule doesn&#x27;t
apply to the client.</p><p><strong>Examples:</strong></p><ul><li><p><code>||example.org^$ctag=device_pc|device_phone</code>: block <code>example.org</code> for clients
tagged as <code>device_pc</code> or <code>device_phone</code>.</p></li><li><p><code>||example.org^$ctag=~device_phone</code>: block <code>example.org</code> for all clients
except those tagged as <code>device_phone</code>.</p></li></ul><p>The list of allowed tags:</p><ul><li><p>By device type:</p><ul><li><code>device_audio</code>: audio devices.</li><li><code>device_camera</code>: cameras.</li><li><code>device_gameconsole</code>: game consoles.</li><li><code>device_laptop</code>: laptops,</li><li><code>device_nas</code>: NAS (Network-attached Storages).</li><li><code>device_pc</code>: PCs.</li><li><code>device_phone</code>: phones.</li><li><code>device_printer</code>: printers.</li><li><code>device_securityalarm</code>: security alarms.</li><li><code>device_tablet</code>: tablets.</li><li><code>device_tv</code>: TVs.</li><li><code>device_other</code>: other devices.</li></ul></li><li><p>By operating system:</p><ul><li><code>os_android</code>: Android.</li><li><code>os_ios</code>: iOS.</li><li><code>os_linux</code>: Linux.</li><li><code>os_macos</code>: macOS.</li><li><code>os_windows</code>: Windows.</li><li><code>os_other</code>: other OSes.</li></ul></li><li><p>By user group:</p><ul><li><code>user_admin</code>: administrators.</li><li><code>user_regular</code>: regular users.</li><li><code>user_child</code>: children.</li></ul></li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor" id="etc-hosts-syntax"></a><code>/etc/hosts</code>-Style Syntax<a class="hash-link" href="#etc-hosts-syntax" title="–ü—Ä—è–º–∞—è —Å—Å—ã–ª–∫–∞ –Ω–∞ —ç—Ç–æ—Ç –∑–∞–≥–æ–ª–æ–≤–æ–∫">#</a></h2><p>For each host a single line should be present with the following information:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly none"><pre tabindex="0" class="prism-code language-none codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">IP_address canonical_hostname [aliases...]</span></span></code></pre><button type="button" aria-label="–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞" class="copyButton_Ue-o clean-btn">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å</button></div></div><p>Fields of the entries are separated by any number of space or tab characters.
Text from the <code>#</code> character until the end of the line is a comment and is
ignored.</p><p>Hostnames may contain only alphanumeric characters, hyphen-minus signs (<code>-</code>),
and periods (<code>.</code>).  They must begin with an alphabetic character and end with an
alphanumeric character.  Optional aliases provide for name changes, alternate
spellings, shorter hostnames, or generic hostnames (for example, <code>localhost</code>).</p><p><strong>Example:</strong></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly none"><pre tabindex="0" class="prism-code language-none codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain"># This is a comment</span></span><span class="token-line" style="color:#393A34"><span class="token plain">127.0.0.1 example.org example.info</span></span><span class="token-line" style="color:#393A34"><span class="token plain">127.0.0.1 example.com</span></span><span class="token-line" style="color:#393A34"><span class="token plain">127.0.0.1 example.net # this is also a comment</span></span></code></pre><button type="button" aria-label="–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞" class="copyButton_Ue-o clean-btn">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å</button></div></div><p>The IP addresses are used to respond to the DNS queries for these domains.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor" id="domains-only-syntax"></a>Domains-Only Syntax<a class="hash-link" href="#domains-only-syntax" title="–ü—Ä—è–º–∞—è —Å—Å—ã–ª–∫–∞ –Ω–∞ —ç—Ç–æ—Ç –∑–∞–≥–æ–ª–æ–≤–æ–∫">#</a></h2><p>A simple list of domain names, one name per line.</p><p>Example:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly none"><pre tabindex="0" class="prism-code language-none codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain"># This is a comment</span></span><span class="token-line" style="color:#393A34"><span class="token plain">example.com</span></span><span class="token-line" style="color:#393A34"><span class="token plain">example.org</span></span><span class="token-line" style="color:#393A34"><span class="token plain">example.net # this is also a comment</span></span></code></pre><button type="button" aria-label="–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞" class="copyButton_Ue-o clean-btn">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å</button></div></div><p>If a string is not a valid domain (e.g. <code>*.example.org</code>), AdGuard Home will
consider it to be an <a href="#adblock-style-syntax">Adblock-style</a> rule.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor" id="hostlists-compiler"></a>Hostlists Compiler<a class="hash-link" href="#hostlists-compiler" title="–ü—Ä—è–º–∞—è —Å—Å—ã–ª–∫–∞ –Ω–∞ —ç—Ç–æ—Ç –∑–∞–≥–æ–ª–æ–≤–æ–∫">#</a></h2><p>If you are maintaining a blocklist and use different sources in it, <a href="https://github.com/AdguardTeam/HostlistCompiler" target="_blank" rel="noopener noreferrer">Hostlists
compiler</a> may be useful to you.  It is a simple tool that makes it easier
to compile a hosts blocklist compatible with AdGuard Home or any other AdGuard
product with DNS filtering.</p><p>What it&#x27;s capable of:</p><ol><li><p>Compile a single blocklist from multiple sources.</p></li><li><p>Exclude the rules you don&#x27;t need.</p></li><li><p>Cleanup the resulting list: deduplicate, remove invalid rules, and compress
the list.</p></li></ol></div><footer class="row docusaurus-mt-lg"><div class="col"><a href="https://github.com/AdguardTeam/KnowledgeBaseVPN/edit/master/docs/general/dns-filtering-syntax.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>–û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —ç—Ç—É —Å—Ç—Ä–∞–Ω–∏—Ü—É</a></div><div class="col lastUpdated_3DPF"></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="–ù–∞–≤–∏–≥–∞—Ü–∏—è –ø–æ —Å—Ç—Ä–∞–Ω–∏—Ü–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/KnowledgeBaseVPN/ru/general/dns-filtering"><div class="pagination-nav__sublabel">–ü—Ä–µ–¥—ã–¥—É—â–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞</div><div class="pagination-nav__label">¬´ DNS filtering</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/KnowledgeBaseVPN/ru/general/dns-providers"><div class="pagination-nav__sublabel">–°–ª–µ–¥—É—é—â–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞</div><div class="pagination-nav__label">Known DNS Providers ¬ª</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#introduction" class="table-of-contents__link">Introduction</a></li><li><a href="#basic-examples" class="table-of-contents__link">Basic Examples</a></li><li><a href="#adblock-style-syntax" class="table-of-contents__link">Adblock-Style Syntax</a><ul><li><a href="#rule-modifiers" class="table-of-contents__link">Rule Modifiers</a></li></ul></li><li><a href="#etc-hosts-syntax" class="table-of-contents__link"><code>/etc/hosts</code>-Style Syntax</a></li><li><a href="#domains-only-syntax" class="table-of-contents__link">Domains-Only Syntax</a></li><li><a href="#hostlists-compiler" class="table-of-contents__link">Hostlists Compiler</a></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">dns</div><ul class="footer__items"><li class="footer__item">Cloud-based DNS service that will help you protect privacy and block ads.</li></ul></div><div class="col footer__col"><div class="footer__title">dns</div><ul class="footer__items"><li class="footer__item"><a href="https://adguard-dns.io/public-dns.html" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>connect_dns<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://adguard-dns.io/support.html" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>support_center<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://adguard-dns.io/support/faq.html" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>faq<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">engage</div><ul class="footer__items"><li class="footer__item"><a href="https://adguard.com/blog/tag/adguard-dns.html" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>blog<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://adguard.com/privacy/dns.html" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>privacy_policy<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://adguard.com/eula.html" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>terms<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://status.adguard.com/" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>status<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">other_products</div><ul class="footer__items"><li class="footer__item"><a href="https://adguard.com" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>ad_blocker<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://adguard-vpn.com" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>vpn<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="margin-bottom--sm"><img src="/KnowledgeBaseVPN/ru/img/logo_dark.svg" alt="AdGuard DNS" class="themedImage_1VuW themedImage--light_3UqQ footer__logo"><img src="/KnowledgeBaseVPN/ru/img/logo_dark.svg" alt="AdGuard DNS" class="themedImage_1VuW themedImage--dark_hz6m footer__logo"></div><div class="footer__copyright">¬© AdGuard DNS, 2022</div></div></div></footer></div>
<script src="/KnowledgeBaseVPN/ru/assets/js/runtime~main.a635b8b4.js"></script>
<script src="/KnowledgeBaseVPN/ru/assets/js/main.0779a69d.js"></script>
</body>
</html>